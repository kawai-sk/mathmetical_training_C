%分割数2の有限要素法
function r=fini(x)
%定数
L = 1;
c = 0.01;
d = 0.01;
E = 2.1*10^11;
F = 2;
p = 7.6;
h = L/2;
I = c*d^3/12;

%v_0,v_1の計算
K = (E*I/h^3)*[12,6,-12,6;6,4,-6,2;-12,-6,24,0;6,2,0,8];
l = (p*h/12)*[6;1;12;0];
f = F*[1;0;0;0];
v = K\(-l-f);

%v(x)の計算
if x > h;v = [v(3);v(4);0;0];end; %xの値による条件分岐　
if x <= h;z = x/h;else;z = (x-h)/h;end;
f_1 = 2*z^3-3*z^2+1;
f_2 = z^3-2*z^2+z;
f_3  = -2*z^3+3*z^2;
f_4 = z^3-z^2;
r = [f_1,f_2,f_3,f_4]*v;
end