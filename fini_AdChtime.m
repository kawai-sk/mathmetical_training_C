%分割数2^nの場合の有限要素法
function t = fini_AdChtime(x,n)
%定数
L = 1;
c = 0.01;
d = 0.01;
E = 2.1*10^11;
F = 2;
p = 7.6;
h = L/(2^n);
I = c*d^3/12;

%K,lを求めてv=[v_0,hv'_0,v_1,hv'_1,...,v_(2^n-1),hv'_(2^n-1),を計算
K_0 = (E*I/h^3)*[12,6,-12,6;6,4,-6,2;-12,-6,12,-6;6,2,-6,4];
l_0 = (p*h/12)*[6;1;6;-1];
K = zeros(2^(n+1),2^(n+1));
l = zeros(2^(n+1),1);
f = zeros(2^(n+1),1);
f(1) = F;
for i = 0:(2^n-2);
    K(2*i+1:2*(i+2),2*i+1:2*(i+2)) = K_0+K(2*i+1:2*(i+2),2*i+1:2*(i+2));
    l(2*i+1:2*(i+2)) = l_0+l(2*i+1:2*(i+2));
end;
K(2^(n+1)-1:2^(n+1),2^(n+1)-1:2^(n+1)) = K_0(1:2,1:2)+K(2^(n+1)-1:2^(n+1),2^(n+1)-1:2^(n+1));
l(2^(n+1)-1:2^(n+1)) = l_0(1:2)+l(2^(n+1)-1:2^(n+1));
tic();
AdCh_solve(K,-l-f);
t = toc();
end