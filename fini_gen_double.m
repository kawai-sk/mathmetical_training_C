%•ªŠ„”2^n‚Ìê‡‚Ì—LŒÀ—v‘f–@,K^2v=K(-l-f)‚ğ‰ğ‚­
function r = fini_gen(x,n)
%’è”
L = 1;
c = 0.01;
d = 0.01;
E = 2.1*10^11;
F = 2;
p = 7.6;
h = L/(2^n);
I = c*d^3/12;

%K,l‚ğ‹‚ß‚Äv=[v_0,hv'_0,v_1,hv'_1,...,v_(2^n-1),hv'_(2^n-1),‚ğŒvZ
K_0 = (E*I/h^3)*[12,6,-12,6;6,4,-6,2;-12,-6,12,-6;6,2,-6,4];
l_0 = (p*h/12)*[6;1;6;-1];
K = zeros(2^(n+1),2^(n+1));
l = zeros(2^(n+1),1);
f = zeros(2^(n+1),1);
f(1) = F;
for i = 0:(2^n-2);
    K(2*i+1:2*(i+2),2*i+1:2*(i+2)) = K_0+K(2*i+1:2*(i+2),2*i+1:2*(i+2));
    l(2*i+1:2*(i+2)) = l_0+l(2*i+1:2*(i+2));
end;
K(2^(n+1)-1:2^(n+1),2^(n+1)-1:2^(n+1)) = K_0(1:2,1:2)+K(2^(n+1)-1:2^(n+1),2^(n+1)-1:2^(n+1));
l(2^(n+1)-1:2^(n+1)) = l_0(1:2)+l(2^(n+1)-1:2^(n+1));
v = K^2\K*(-l-f);

%v(x)‚ğŒvZ‚·‚é‚½‚ß‚ÌğŒ•ªŠò
k = 0;
while x-(k+1)*h > 0;
    k = k+1;
end;
z = (x-k*h)/h;
if k == 2^n-1;
    V = [v(2^(n+1)-1);v(2^(n+1));0;0];
else;
    V = [v(2*k+1);v(2*k+2);v(2*k+3);v(2*k+4)];
end;

%v(x)‚ğŒvZ
f_1 = 2*z^3-3*z^2+1;
f_2 = z^3-2*z^2+z;
f_3  = -2*z^3+3*z^2;
f_4 = z^3-z^2;
r = [f_1,f_2,f_3,f_4]*V;
end